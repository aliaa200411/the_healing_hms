<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <template id="report_prescription_qweb">
        <t t-call="web.external_layout">
            <t t-set="doc" t-value="docs[0]"/>

            <!-- محتوى الوصفة الطبية -->
            <main class="page" style="font-family:Arial, sans-serif; color:#2c3e50; min-height:100vh; display:flex; flex-direction:column;">

                <!-- Header -->
                <header style="display:flex; justify-content:center; align-items:center; margin-bottom:30px; gap:40px;">
           <div style="text-align:center;">
                        <h1 style="margin:0; font-size:28px; color:#34495e;">The Healing Coders Hospital</h1>
                        <h2 style="margin:0; margin-top:5px; font-size:22px; color:#e74c3c;">Medical Prescription </h2>
                        <div style="font-size:14px; color:#7f8c8d; margin-top:5px;">
                            <div>Date: <strong t-esc="doc.date.strftime('%Y-%m-%d') if doc.date else ''"/></div>
                        </div>
                    </div>
                </header>

                <!-- معلومات المريض والطبيب + ملاحظات -->
                <div style="margin-bottom:30px; background-color:#f8f9fa; padding:15px; border-radius:8px;">
                    <table style="width:100%; border-collapse:collapse; font-size:14px;">
                        <tr>
                            <th style="text-align:left; width:120px; padding:5px;">Patient:</th>
                            <td style="padding:5px; font-weight:bold;" t-esc="doc.patient_id.name or '-'"/>
                            <th style="text-align:left; width:120px; padding:5px;">Doctor:</th>
                            <td style="padding:5px; font-weight:bold;" t-esc="doc.doctor_id.user_id.name or '-'"/>
                        </tr>
                        <tr>
                            <th style="text-align:left; padding:5px;">Notes:</th>
                            <td colspan="3" style="padding:5px;" t-esc="doc.note or ''"/>
                        </tr>
                    </table>
                </div>

                <!-- جدول الأدوية -->
                <div style="flex-grow:1;">
                    <table style="width:100%; border-collapse:collapse; font-size:14px; margin-bottom:20px;">
                        <thead style="background-color:#ecf0f1; font-weight:bold;">
                            <tr>
                                <th style="border:1px solid #bdc3c7; padding:8px;">Medicine</th>
                                <th style="border:1px solid #bdc3c7; padding:8px;">Medicine Form</th>
                                <th style="border:1px solid #bdc3c7; padding:8px;">Dosage</th>
                                <th style="border:1px solid #bdc3c7; padding:8px;">Times/Day</th>
                                <th style="border:1px solid #bdc3c7; padding:8px;">Duration</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr t-foreach="doc.line_ids" t-as="line">
                                <td style="border:1px solid #bdc3c7; padding:6px;" t-esc="line.medicine_name or ''"/>
                                <td style="border:1px solid #bdc3c7; padding:6px;" t-esc="line.medicine_form or ''"/>
                                <td style="border:1px solid #bdc3c7; padding:6px;" t-esc="line.dosage or ''"/>
                                <td style="border:1px solid #bdc3c7; padding:6px;" t-esc="line.times_per_day or ''"/>
                                <td style="border:1px solid #bdc3c7; padding:6px;" t-esc="line.duration or ''"/>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Footer -->
                <footer style="margin-top:auto; padding-top:20px; border-top:1px solid #ecf0f1;">
                    <div style="font-size:12px; color:#7f8c8d; text-align:center;">
                        <p style="margin:0;">Signature: ____________________</p>
                    </div>
                </footer>

            </main>
        </t>
    </template>

    <record id="action_report_prescription" model="ir.actions.report">
        <field name="name">Prescription Report</field>
        <field name="model">hospital.prescription</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">the_healing_hms.report_prescription_qweb</field>
        <field name="print_report_name">object.patient_id.name if object.patient_id else 'Prescription'</field>
    </record>
</odoo>
